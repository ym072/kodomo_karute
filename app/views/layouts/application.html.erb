<!DOCTYPE html>
<html>
  <head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  
    <title><%= content_for(:title) || "kodomo-karute App" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <meta property="og:title" content="こどもカルテ" />
    <meta property="og:description" content="うんちや嘔吐、体温の変化。看病中に把握するのは大変ですよね。お子さんの症状、私がまとめておきます。" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://medical-record-xqit.onrender.com/pages/home" />
    <meta property="og:image" content="<%= image_url('ogp.png') %>" />
    <meta name="twitter:card" content="summary_large_image" />


    <%= stylesheet_link_tag "application", media: "all", "data-turbo-track": "reload", media: "all" %>

    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">
    <%= javascript_importmap_tags %>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <%= yield :head %>
  </head>

  <body>
  <header class="site-header">
    <%= link_to (user_signed_in? ? kids_path : new_user_session_path), class: "logo-link" do %>
    <%= image_tag 'logo.png', class: "site-logo" %>
    <% end %>

    <% unless user_signed_in? %>
    <div class="header-auth">
      <%= link_to "ログイン", new_user_session_path, class: "auth-button auth-button--login" %>
      <%= link_to "新規登録", new_user_registration_path, class: "auth-button auth-button--signup" %>
    </div>
  <% end %>

    <% on_kids_pages = controller_name == "kids" && action_name.in?(%w[index new create edit update]) %>
    <% show_kid_nav = user_signed_in? && current_kid.present? && !on_kids_pages %>
    <% if show_kid_nav %>
      <nav class="nav-menu">
        <%= link_to "記録", new_kid_reported_symptom_path(current_kid), class: "nav-button" %>
        <%= link_to "サマリー", summary_kid_reported_symptoms_path(current_kid), class: "nav-button" %>
        <%= link_to "一覧", kid_disease_records_path(current_kid), class: "nav-button" %>
      </nav>
    <% end %>

    <% if user_signed_in? %>
      <div class="header-right">
        <button type="button" class="menu-toggle" aria-controls="header-menu" aria-expanded="false">
          <span class="menu-icon" aria-hidden="true"></span>
          <span class="sr-only">メニュー</span>
        </button>

        <div id="header-menu" class="dropdown-menu" hidden>
          <%= link_to "お子さま一覧", kids_path, class: "dropdown-item" %>
          <%= button_to "ログアウト", destroy_user_session_path, method: :delete, class: "dropdown-item" %>
        </div>
      </div>
    <% end %>
  </header>

  <%= turbo_frame_tag "modal" %>

  <% if flash[:notice] %>
    <div class="flash flash-notice"><%= flash[:notice] %></div>
  <% end %>

  <% if flash[:alert] %>
    <div class="flash flash-alert"><%= flash[:alert] %></div>
  <% end %>

  <%= yield %>

  <footer class="site-footer">
    <%= link_to "利用規約", terms_path %>
    <span>｜</span>
    <%= link_to "プライバシーポリシー", privacy_path %>
  </footer>

  </body>
</html>
